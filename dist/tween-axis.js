/*!
 * rtween
 * Copyright (C) 2019  Nathanael Braun
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 * 
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
module.exports=function(t){var s={};function e(i){if(s[i])return s[i].exports;var n=s[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=t,e.c=s,e.d=function(t,s,i){e.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,s){if(1&s&&(t=e(t)),8&s)return t;if(4&s&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var n in t)e.d(i,n,function(s){return t[s]}.bind(null,n));return i},e.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(s,"a",s),s},e.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},e.p="/",e(e.s=11)}([function(t,s){t.exports=require("is")},function(t,s){t.exports=require("@babel/runtime/helpers/objectSpread")},function(t,s){t.exports=require("@babel/runtime/helpers/classCallCheck")},function(t,s){t.exports=require("@babel/runtime/helpers/createClass")},function(t,s,e){var i={"./Event.js":5,"./Ring.js":6,"./SVGPath.js":7,"./Tween.js":9};function n(t){var s=r(t);return e(s)}function r(t){if(!e.o(i,t)){var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}return i[t]}n.keys=function(){return Object.keys(i)},n.resolve=r,t.exports=n,n.id=4},function(t,s){t.exports=function(t,s,e){return function(t,s,e,i,n){i.entering&&(0!==t&&1!==t||i.entering(s)),i.leaving&&(0===t||1===t||t+s!==0&&t+s!==1||i.leaving(s))}},t.exports.isFactory=!0},function(t,s,e){var i=Math.PI,n=e(0).number;Math.sin,Math.cos;t.exports=function(t,s,e){e&&t&&(t=t[e]=t[e]||{});var r="var _2PI=2*Math.PI,",o=s.axes&&s.axes[0]||"x",_=s.axes&&s.axes[1]||"y",a=(s.factors&&s.factors[0]||1)*s.radius,h=(s.factors&&s.factors[1]||1)*s.radius,c=2*(s.startPos||0)*i,u=n(s.length)?s.length:1;return r+="pos1=("+c+"+((lastPos+update)*_2PI)*"+u+" )%(_2PI),pos2 = ("+c+"+(lastPos)*_2PI*"+u+" )%(_2PI);",r+="scope."+o+"+="+a+"*(Math.cos(pos1)-Math.cos(pos2));scope."+_+" += "+h+"*(Math.sin(pos1)-Math.sin(pos2));",new Function("lastPos, update, scope, cfg, target",r)},t.exports.isFactory=!0},function(t,s,e){var i,n,r={};"undefined"==typeof document?(i=function(t){return r[t]||e(8)(t)},n=function(t,s){return r[t].at(s)}):(i=function(t){var s=r[t];s||(r[t]=s=document.createElementNS("http://www.w3.org/2000/svg","path"),s.setAttribute("d",t))},n=function(t,s){return r[t].getPointAtLength(s*r[t].getTotalLength())}),t.exports=function(t,s,e){var r,o,_=s.axes&&s.axes[0]||"x",a=s.axes&&s.axes[1]||"y";return i(s.path),function(t,s,e,i,h){var c=r==t?o:n(i.path,i.reverse?1-t:t),u=o=n(i.path,i.reverse?1-(t+s):t+s);r=t+s,e[_]+=4*(u.x-c.x),e[a]+=4*(u.y-c.y)}},t.exports.isFactory=!0},function(t,s){t.exports=require("point-at-length")},function(t,s){t.exports=function(t,s,e){var i="";for(var n in e&&(i+="scope = scope['"+e+"'];\n"),s.apply)s.apply.hasOwnProperty(n)&&(t&&(t[n]=t[n]||0),i+="scope."+n+"+=("+(s.easeFn?"cfg.easeFn(lastPos+update)- cfg.easeFn(lastPos)":"update")+") * cfg.apply."+n+";");return new Function("lastPos, update, scope, cfg, target",i)},t.exports.isFactory=!0},function(t,s){t.exports=require("d3-ease")},function(t,s,e){"use strict";e.r(s);var i,n=e(1),r=e.n(n),o=e(2),_=e.n(o),a=e(3),h=e.n(a),c=e(0),u=e.n(c),g={};(i=e(4)).keys().forEach(function(t){var s,e=t.match(/^\.\/([^\\\/]+)\.js$/);e=e&&e[1]||t.substr(2),g[e]||(s=i(t),g[e]=1===Object.keys(s).length&&s.default||s)});g.Event,g.Ring,g.SVGPath,g.Tween;var l,p=g,f=e(10),m=u.a.array,d=u.a.number,k=u.a.string,y=(Array.prototype.slice,Array.prototype.push),v=Math.abs,x=!1,P=[],L=function(){function t(s,e){_()(this,t),this.scope=e,s=s||{},this.__marks=[],this.__marksLength=[],this.__marksKeys=[],this.__processors=[],this.__config=[],this.__activeForks=[],this.__activeProcess=[],this.__activeProcess=[],this.__outgoing=[],this.__incoming=[],this.__cPos=0,this.__cIndex=0,this.__cMaxKey=1,m(s)?(this.localLength=1,this.mount(s,e)):(Object.assign(this,s),s.TweenAxis&&this.mount(s.TweenAxis,e))}return h()(t,[{key:"run",value:function(s,e,i){t.Runner.run(this,s,i||this.duration,e)}},{key:"runTo",value:function(s,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t},r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,_=this.__cPos,a=s-_;P.push({apply:function(t,s){var e=_+n(t/s)*a;i.goTo(e),r&&r(e)},duration:e,cpos:0,cb:o}),x||(x=!0,l=Date.now(),setTimeout(t.Runner._tick,16))}},{key:"mount",value:function(t,s){var e,i,n,o=this.duration||0,_=0;for(e=0,i=t.length;e<i;e++)k(t[e].easeFn)&&(t[e]=r()({},t[e],{easeFn:f[t[e].easeFn]||!1})),(n="Subline"==t[e].type?t[e].apply.fork(null,t[e],t[e].easeFn):p[t[e].type||"Tween"])?d(t[e].from)?(this.addProcess(t[e].from,t[e].from+t[e].duration,n,t[e]),_=Math.max(_,t[e].from+t[e].duration)):(this.addProcess(o,o+t[e].duration,n,t[e]),o+=t[e].duration||0):console.log("TweenAxis : Anim not found : "+t[e].type);return this.duration=Math.max(o,_),this}},{key:"fork",value:function(t){return this._masterLine=this._masterLine||this,forkedTweenAxis.prototype=this._masterLine,new forkedTweenAxis(t)}},{key:"addProcess",value:function(s,e,i,n){var r=0,o=(i.localLength,e-s||0),_=this.__cMaxKey++;for(i instanceof t&&(i=i.fork(null,n)),this.__activeForks[_]=!0,this.__processors[_]=i.isFactory?i(null,n,n.target):i,this.__marksLength[_]=o,this.__config[_]=n;r<=this.__marks.length&&this.__marks[r]<s;)r++;for(this.__marks.splice(r,0,s),this.__marksKeys.splice(r,0,_);r<=this.__marks.length&&this.__marks[r]<=e;)r++;return this.__marks.splice(r,0,e),this.__marksKeys.splice(r,0,-_),this}},{key:"_getIndex",value:function(t){return-1!==(t=this.__marksKeys.indexOf(t))&&t}},{key:"go",value:function(t,s,e){return this.goTo(t*this.duration,s,e),this.__cRPos=t,s||this.scope}},{key:"getPosAt",value:function(t,s){return this.__activeProcess.length=0,this.__outgoing.length=0,this.__incoming.length=0,this.__cPos=0,this.__cIndex=0,this.go(t,s)}},{key:"goTo",value:function(t,s,e){s=s||this.scope,this.window&&(t=this.window.start+t/this.duration*this.window.length),this._started||(this._started=!0,this.__cIndex=this.__cPos=0);var i,n,r,o,_,a,h=this.__cIndex,c=this.__outgoing,u=this.__incoming,g=this.__marks.length,l=t-this.__cPos;for(e&&(this.__activeProcess.length=0,this.__outgoing.length=0,this.__incoming.length=0);h<g&&t>this.__marks[h]||l>=0&&this.__marks[h]==t;)-1!=(i=this.__activeProcess.indexOf(-this.__marksKeys[h]))?(this.__activeProcess.splice(i,1),c.push(this.__marksKeys[h])):-1!=(i=this.__activeProcess.indexOf(this.__marksKeys[h]))?(this.__activeProcess.splice(i,1),c.push(this.__marksKeys[h])):-1!=(i=u.indexOf(-this.__marksKeys[h]))?(u.splice(i,1),c.push(this.__marksKeys[h])):u.push(this.__marksKeys[h]),h++;for(;h-1>=0&&(t<this.__marks[h-1]||l<0&&this.__marks[h-1]==t);)h--,-1!=(i=this.__activeProcess.indexOf(-this.__marksKeys[h]))?(this.__activeProcess.splice(i,1),c.push(this.__marksKeys[h])):-1!=(i=this.__activeProcess.indexOf(this.__marksKeys[h]))?(this.__activeProcess.splice(i,1),c.push(this.__marksKeys[h])):-1!=(i=u.indexOf(-this.__marksKeys[h]))?(u.splice(i,1),c.push(this.__marksKeys[h])):u.push(this.__marksKeys[h]);for(this.__cIndex=h,h=0,n=c.length;h<n;h++)i=this._getIndex(c[h]),a=v(c[h]),c[h]<0?(r=o=Math.min(this.__marks[i],Math.max(this.__cPos,this.__marks[i]-this.__marksLength[a]))-(this.__marks[i]-this.__marksLength[a]),_=this.__marksLength[a]-o,r=(this.localLength||1)*r/this.__marksLength[a],_=(this.localLength||1)*_/this.__marksLength[a]):(r=o=Math.max(this.__marks[i],Math.min(this.__cPos,this.__marks[i]+this.__marksLength[a]))-this.__marks[i],_=0-o,r=(this.localLength||1)*r/this.__marksLength[a],_=(this.localLength||1)*_/this.__marksLength[a]),this.__processors[a].go?this.__processors[a].go(r+_,s,e):this.__processors[a](r,_,s,this.__config[a],this.__config[a].target||this.__config[a].$target&&this.__context&&this.__context[this.__config[a].$target]);for(h=0,n=u.length;h<n;h++)i=this._getIndex(u[h]),a=v(u[h]),u[h]<0?(r=o=this.__marksLength[a],_=Math.max(this.__marks[i]-this.__marksLength[a],Math.min(this.__cPos+l,this.__marks[i]))-(this.__marks[i]-this.__marksLength[a])-o,r=(this.localLength||1)*r/this.__marksLength[a],_=(this.localLength||1)*_/this.__marksLength[a]):(r=o=0,_=Math.max(this.__marks[i],Math.min(this.__cPos+l,this.__marks[i]+this.__marksLength[a]))-this.__marks[i]-o,r=(this.localLength||1)*r/this.__marksLength[a],_=(this.localLength||1)*_/this.__marksLength[a]),this.__processors[a].go?(this.__processors[a].go(r,0,!0),this.__processors[a].go(r+_,s)):e||this.__processors[a](r,_,s,this.__config[a],this.__config[a].target||this.__config[a].$target&&this.__context&&this.__context[this.__config[a].$target]);for(h=0,n=this.__activeProcess.length;h<n;h++)i=this._getIndex(this.__activeProcess[h]),a=v(this.__activeProcess[h]),r=this.__activeProcess[h]<0?this.__cPos-(this.__marks[i]-this.__marksLength[a]):this.__cPos-this.__marks[i],r=(this.localLength||1)*r/this.__marksLength[a],_=l*(this.localLength||1)/this.__marksLength[a],this.__processors[a].go?this.__processors[a].go(r+_,s):e||this.__processors[a](r,_,s,this.__config[a],this.__config[a].target||this.__config[a].$target&&this.__context&&this.__context[this.__config[a].$target]);y.apply(this.__activeProcess,u),c.length=0,u.length=0,this.__cPos=t,this.onScopeUpdated&&this.onScopeUpdated(t,l,s)}}]),t}();L.Runner={run:function(t,s,e,i){P.push({apply:function(e,i){return t.go(e/i,s)},duration:e,cpos:0,cb:i}),t.go(0,s,!0),x||(x=!0,l=Date.now(),setTimeout(this._tick,16))},_tick:function t(){var s=0,e=Date.now(),i=e-l;for(l=e;s<P.length;s++)P[s].cpos=Math.min(i+P[s].cpos,P[s].duration),P[s].apply(P[s].cpos,P[s].duration),P[s].cpos==P[s].duration&&(P[s].cb&&setTimeout(P[s].cb),P.splice(s,1),s--);P.length?setTimeout(t,16):x=!1}},e.d(s,"rTween",function(){return b});s.default=L;var b=L}]);